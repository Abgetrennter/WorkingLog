# 4. 部署运维手册

## 4.1 系统要求
- **操作系统**: Windows 7 SP1 及以上 (推荐 Windows 10/11)
- **依赖环境**: .NET Framework 4.7.2 (系统自带)
- **硬件要求**: 
  - CPU: 1GHz+
  - RAM: 512MB+
  - Disk: 50MB+ (取决于日志数据量)

## 4.2 安装步骤
1. **下载**: 从发布页获取 `WorkLogApp_vX.X.zip`。
2. **解压**: 解压至全英文路径（避免部分系统编码问题），如 `D:\Soft\WorkLog`。
3. **运行**: 双击 `WorkLogApp.UI.exe`。
4. **初始化**: 首次运行会自动生成 `Data` 和 `Templates` 目录。

## 4.3 配置文件
位于 `Configs/` 目录下（发布后位于根目录或 Configs 子目录）：

- **dev.config.json**: 开发环境配置。
- **prod.config.json**: 生产环境配置。

目前配置主要包含：
- `TemplatePath`: 模板文件路径（默认 `Templates/templates.json`）。
- `DataPath`: 数据存储路径（默认 `Data`）。

## 4.4 数据备份与恢复
本系统数据完全本地化，备份非常简单。

### 备份
定期复制以下两个文件夹到安全位置（如网盘、NAS）：
- `/Data/`: 包含所有 Excel 日志文件。
- `/Templates/`: 包含所有自定义模板。

### 恢复
1. 在新机器上安装程序。
2. 将备份的 `Data` 和 `Templates` 文件夹覆盖到程序根目录。
3. 重启程序即可。

## 4.5 日志与排错
- **系统日志**: 程序运行错误会记录在 `/Logs/` 目录下（按日期命名）。
- **常见报错**:
  - `IOException`: 通常是 Excel 文件被其他程序（如 WPS/Excel）占用，请关闭文件后重试。
  - `UnauthorizedAccessException`: 请确保程序有所在目录的读写权限（避免安装在 `C:\Program Files`）。
