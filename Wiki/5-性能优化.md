# 5. 性能优化指南

尽管本项目是轻量级桌面应用，但在数据量增大时仍需注意性能问题。以下是针对性的优化策略。

## 5.1 Excel 读写优化
Excel 操作是本系统最耗时的部分。

- **按需读取**: 系统默认只加载当前选定月份的数据，而非加载所有历史数据。
- **批量写入**: 
  - 在 "导入向导" 中，系统将所有数据在内存中处理完毕后，一次性写入 Excel，避免频繁打开/关闭文件流。
  - 在 "双击编辑" 保存时，虽然只修改一条，但由于 Excel 结构的特殊性（重排版），系统会重写当月文件。**建议**: 避免在当月积累过多数据（如超过 1000 条），否则保存会有轻微卡顿。

## 5.2 UI 渲染优化
- **双缓冲 (Double Buffering)**: 列表控件开启了双缓冲，防止刷新时闪烁。
- **虚拟化思路**: 虽然 WinForms ListView 不是完全虚拟化的，但系统通过仅重新绑定当前视图（日/月）的数据来减少渲染压力。
- **资源释放**: 
  - 所有的 Form 在关闭时均调用 `Dispose()`。
  - GDI+ 对象（如字体、画笔）在 `UIStyleManager` 中统一管理，避免内存泄漏。

## 5.3 启动速度
- **延迟加载**: 
  - 模板文件 `templates.json` 仅在程序启动时加载一次。
  - 历史数据文件仅在用户切换月份时加载。

## 5.4 大数据量建议
如果您的单月日志条目超过 2000 条，建议：
1. **分月归档**: 保持按月分文件的默认策略。
2. **减少富文本**: 尽量减少极长文本的记录，虽然 Excel 支持 32k字符/单元格，但过长文本会影响加载速度。
