# 工作日志桌面应用 - 使用指南

## 快速开始

- 双击运行 `WorkLogApp.UI.exe`（首次运行自动创建 `Data` 目录）。
- 程序会加载 `Templates/templates.json` 中的模板；可在“分类管理”中编辑并保存到该文件。
- 每月数据写入 `Data` 目录下的 `worklog_yyyyMM.xlsx`（例如：`worklog_202511.xlsx`）。

## 主界面概览

- `创建事项`：打开模板创建窗口，按分类模板填写表单生成日志内容。
- `按月显示`：勾选后显示月视图，使用右侧 `yyyy-MM` 选择器切换月份；不勾选则显示日视图，使用 `yyyy-MM-dd` 选择器切换日期。
- `分类管理`：管理分类与模板（占位符与选项）。
- `导入向导`：从外部 Excel 批量导入数据（自动按月分组写入）。
- `每日总结`：在日视图下为当前日期编辑“当日总结”。
- `刷新`：重新加载当前月份数据并绑定列表。
- `保存`：保存当前排序与总结到当月 Excel。
- `打开EXCEL`：在资源管理器中打开当前月份的 Excel 文件或数据目录。

## 创建与编辑

- 创建：点击 `创建事项`，选择分类并填写动态表单，确认后保存；保存完成自动刷新当月数据。
- 编辑：在列表中双击条目，进入纯文本编辑窗口，保存后将重写当月 Excel 并刷新列表。
- 排序：按住并拖拽列表项进行重排；点击 `保存` 将当前顺序写入 `SortOrder` 并生成当月 Excel。

## 每日总结

- 在日视图点击 `每日总结`，填写当日总结文本；保存后将作为该日块末尾的“当日总结”行写入 Excel。
- 初始值会自动从当日事项标题拼接生成，便于快速编辑。

## 分类与模板

- 新增分类：在“分类管理”中点击新增，创建空模板；占位符类型支持 `text`/`textarea`/`select`/`checkbox`/`datetime`。
- 新增子分类：先选中父分类后新增子分类，系统会复制父模板的占位符与选项，并继承格式文本。
- 模板合并：使用“父-子-孙”多级命名（以 `-` 连接）实现层级合并；渲染时将合并格式文本与占位符。
- 保存模板：在“分类管理”中保存即写回 `Templates/templates.json` 并立即生效。

## 导入数据

- 打开 `导入向导`，选择外部 Excel 文件；预览通过后点击导入。
- 系统按月份分组并写入 `Data` 目录下对应的 `worklog_yyyyMM.xlsx`。
- 识别中文表头（`日期/标题/内容/分类ID/开始时间/结束时间/标签/排序`），并自动解析“当日总结”行（标题为“当日总结”）。
- 分类名称会自动转换为稳定数值ID；无法解析时回退为数值列内容。

## 文件位置与命名

- 数据目录：`Data`（程序同级）
- 月度文件：`worklog_yyyyMM.xlsx`（如：`worklog_202511.xlsx`）
- 模板配置：`Templates/templates.json`
- 打开方式：点击主界面 `打开EXCEL` 按钮自动定位到文件或目录。

## 常见问题

- 未找到当月文件：点击 `保存` 或 `创建事项` 后会自动生成；也可点击 `打开EXCEL` 查看目录。
- 导入失败：确认 Excel 首行存在中文表头或能被识别的列名；导入向导会给出预览与错误提示。
- 模板未生效：确认在“分类管理”已保存；重新打开创建窗口或点击 `刷新` 以更新绑定。

## 兼容性与环境

- 运行环境：Windows 7/10，`.NET Framework 4.7.2`（系统自带，无需额外安装）。
- Excel 支持：使用 NPOI 读写 `.xlsx`，不依赖 Microsoft Office。